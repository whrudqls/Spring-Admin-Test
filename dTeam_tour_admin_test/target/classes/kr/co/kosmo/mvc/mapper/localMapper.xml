<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="local">
	<insert id="addlocal" parameterType="lvo">
		insert into local_semi
		VALUES(local_semi_seq.nextVal,#{larea},#{ltitle},#{lcontent},#{limg},#{htcode},#{lprice},#{tsort})
	</insert>

	<select id="listlocal" resultType="lvo">
		select
		lno,larea,ltitle,lcontent,limg,lprice from local_semi
	</select>

	<select id="detaillocal" resultType="lvo" parameterType="int">
		select
		lno,larea,ltitle,lcontent,limg,lprice from local_semi where
		lno=#{lno}
	</select>

	<delete id="dellocal" parameterType="int">
		delete from local_semi where
		lno=#{lno}
	</delete>

	<update id="modifylocal" parameterType="lvo">
		update local_semi
		set
		larea=#{larea},
		ltitle=#{ltitle},
		lcontent=#{lcontent},
		limg=#{limg},
		lprice=#{lprice}
		where lno=#{lno}
	</update>


	<select id="showList" resultType="lvo">
		SELECT lno,ltitle,limg from
		local_semi
	</select>

	<resultMap type="lvo" id="reviewStarChart">
		<id property="lno" column="lno" javaType="int" />

		<collection property="review" javaType="java.util.List"
			ofType="revo">
			<result property="star" column="star" javaType="int" />
			<result property="starcnt" column="starcnt" javaType="int" />
		</collection>
	</resultMap>

	<select id="chartForReview" parameterType="int"
		resultMap="reviewStarChart">
		select lo.lno,re.star,count(re.star) as starcnt from
		local_semi lo,review_semi re
		where lo.lno=re.recode and lno=#{lno}
		GROUP BY lo.lno,re.star order by 1 desc
	</select>

</mapper>